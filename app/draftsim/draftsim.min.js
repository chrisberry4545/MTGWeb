(function(){"use strict";function t(t,i,r,u,f,e,o){function l(n,t,i){var r=n.indexOf(i);r>-1&&n.splice(r,1);t.push(i)}function k(){t.activateController([],n).then(function(){s.landcards=f.getLandCards();var n=200,t=200;u.setPieChartGraphElement("colorPieChartContainer",n,t);u.setBarChartGraphElement("manaCurveBarChartContainer",n,t);u.setTypeChartHolder("typePieChartContainer",n,t);u.resetAllCanvas()})}function d(){return s.boosters_to_open_core==null||s.boosters_to_open_ths==null||s.boosters_to_open_bng==null||s.boosters_to_open_jou==null||s.boosters_to_open_ktk==null||s.boosters_to_open_frf==null||s.boosters_to_open_dtk==null?(b("Please use a number for the amount of boosters."),!1):!0}function g(){for(var t,n=1;n<s.AIs.length;n++)processTurn(s.AIs[n]);for(t=[],n=0;n<s.AIs.length;n++)t.push(s.AIs[n].boosterCards);for(s.AIs[0].boosterCards=t[s.AIs.length-1],s.boosterCards=s.AIs[0].boosterCards,n=1;n<s.AIs.length;n++)s.AIs[n].boosterCards=t[n-1]}function nt(){var n,t;for(s.AIs=[],n=0;n<s.numberOfPlayers;n++)t=new ai(n),y(t),s.AIs.push(t)}function y(n){var t=s.fixedDTKpacks;return s.packsOpened<=t?i.openMixtureOfSortedBoosters(0,0,0,0,0,0,1).then(function(t){return h(n,t)}):(t+=s.fixedFRFPacks,s.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,0,0,0,0,1,0).then(function(t){return h(n,t)}):(t+=s.fixedKTKPacks,s.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,0,0,0,1,0,0).then(function(t){return h(n,t)}):(t+=s.fixedCorePacks,s.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,0,0,1,0,0,0).then(function(t){return h(n,t)}):(t+=s.fixedJOUpacks,s.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,0,1,0,0,0,0).then(function(t){return h(n,t)}):(t+=s.fixedBNGpacks,s.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,1,0,0,0,0,0).then(function(t){return h(n,t)}):(t+=s.fixedTHSpacks,s.packsOpened<=t?i.openMixtureOfSortedBoosters(1,0,0,0,0,0,0).then(function(t){return h(n,t)}):void 0)}function h(n,t){return n.boosterCards.push.apply(n.boosterCards,t.mythicCards),n.boosterCards.push.apply(n.boosterCards,t.rareCards),n.boosterCards.push.apply(n.boosterCards,t.uncommonCards),n.boosterCards.push.apply(n.boosterCards,t.commonCards),n.boosterCards}var p=t.logger.getLogFn,c=p(n),w=t.logger.getLogFn(n,"success"),b=t.logger.getLogFn(n,"error"),s=this,a,v;s.title="Sealed Simulator";s.column1Title="Image";s.column2Title="Name";s.column3Title="Rarity";s.boosters_to_open=1;s.boosters_to_open_dtk=2;s.boosters_to_open_frf=1;s.boosters_to_open_ktk=0;s.boosters_to_open_core=0;s.boosters_to_open_jou=0;s.boosters_to_open_bng=0;s.boosters_to_open_ths=0;s.boosterCards=[];s.selectedCards=[];s.deckCards=[];s.draftFinished=!1;s.draftStarted=!1;s.packsOpened=0;s.totalPacksToOpen=3;s.fixedDTKpacks=0;s.fixedFRFPacks=0;s.fixedKTKPacks=0;s.fixedCorePacks=0;s.fixedJOUpacks=0;s.fixedBNGpacks=0;s.fixedTHSpacks=0;s.landcards=[];s.selectedLandCards=[];a="Booster Cards";s.topPanelCardsTitle=a;v="Selected Cards Stats";s.cardStatsTitle=v;s.chartsHidden=!1;s.hideCharts=function(){s.chartsHidden=!s.chartsHidden};s.showExtraOptions=!1;s.displayExtraOptions=function(){s.showExtraOptions=s.showExtraOptions?!1:!0};s.downloadFullPool=function(){r.saveCardsList(s.selectedCards.concat(s.deckCards),"MyDraftPool")};s.downloadDraftDeck=function(){r.saveCardsList(s.deckCards.concat(s.selectedLandCards),"MyDeckSelection")};s.addToDeck=function(n){o.postCardSelected(n.Number,n.Set,s.boosterCards.length);l(s.boosterCards,s.selectedCards,n);w("You've chosen "+n.Name+"!");g();s.boosterCards.length==0&&(s.packsOpened<s.totalPacksToOpen?s.openNextPack():(s.draftFinished=!0,s.topPanelCardsTitle="Deck Cards"));u.displayChartsForCards(s.selectedCards)};s.cardPoolClick=function(n){s.draftFinished&&(l(s.selectedCards,s.deckCards,n),s.cardStatsTitle="My Deck Stats",u.displayChartsForCards(s.deckCards))};s.deckCardClick=function(n){s.draftFinished&&(l(s.deckCards,s.selectedCards,n),u.displayChartsForCards(s.deckCards))};s.landCardClick=function(n){s.draftFinished&&s.selectedLandCards.push(n)};s.removeLandCard=function(n){var t=s.selectedLandCards.indexOf(n);t>-1&&s.selectedLandCards.splice(t,1)};s.removeFromDeck=function(n){l(s.selectedCards,s.boosterCards,n)};s.openBoosters=function(){return i.openSortedBoosters(s.boosters_to_open).then(function(n){return c("Opened "+s.boosters_to_open+" booster packs."),s.boosterCards.push.apply(s.boosterCards,n.mythicCards),s.boosterCards.push.apply(s.boosterCards,n.rareCards),s.boosterCards.push.apply(s.boosterCards,n.uncommonCards),s.boosterCards.push.apply(s.boosterCards,n.commonCards),s.boosterCards})};s.openNextPack=function(){c("Opening a new pack...");s.packsOpened++;for(var n=0;n<s.numberOfPlayers;n++)y(s.AIs[n]);s.boosterCards=s.AIs[0].boosterCards;c("Packs opened: "+s.packsOpened+" Total packs to open: "+s.totalPacksToOpen)};k();s.numberOfPlayers=8;s.AIs=[];s.startDraft=function(){if(!d())return!1;s.draftStarted=!0;s.draftFinished=!1;s.topPanelCardsTitle=a;s.cardStatsTitle=v;u.resetAllCanvas();s.boosterCards=[];s.selectedCards=[];s.deckCards=[];s.selectedLandCards=[];s.fixedDTKpacks=parseInt(s.boosters_to_open_dtk);s.fixedFRFPacks=parseInt(s.boosters_to_open_frf);s.fixedKTKPacks=parseInt(s.boosters_to_open_ktk);s.fixedCorePacks=parseInt(s.boosters_to_open_core);s.fixedBNGpacks=parseInt(s.boosters_to_open_bng);s.fixedTHSpacks=parseInt(s.boosters_to_open_ths);s.fixedJOUpacks=parseInt(s.boosters_to_open_jou);s.totalPacksToOpen=s.fixedBNGpacks+s.fixedTHSpacks+s.fixedJOUpacks+s.fixedCorePacks+s.fixedKTKPacks+s.fixedFRFPacks+s.fixedDTKpacks;s.packsOpened=1;nt();s.boosterCards=s.AIs[0].boosterCards;c("You've started a new draft")};s.openHandSimulator=function(){var n=s.deckCards.concat(s.selectedLandCards),t;n.length>0?t=e.open({templateUrl:"handmodal.html",controller:"handmodal",resolve:{fullDeck:function(){return n}}}):c("Please add some cards to your deck (click on them below).")}}var n="draftsim";angular.module("app").controller(n,["common","datacontext","downloadDataService","graphAnalysis","landcards","$modal","webapicontext",t])})();
//# sourceMappingURL=draftsim.min.js.map
