(function(){"use strict";function n(n){function t(n,t,i,r,u){this.fullName=n;this.shortName=t;this.boostersToOpen=0;this.chanceOfFoil=i==null?1/6:i;this.foilReplacesCommon=r==null?!0:r;this.addAdditionalCardsToPacks=function(n,t){return t};u!=null&&(this.addAdditionalCardsToPacks=u)}function v(n){var u=y(),t,i,r;console.log(u);t=o(u.shortName);console.log(t);i=Math.random()>7/8?t.mythicCards:t.rareCards;r=new l(i[Math.floor(Math.random()*i.length)]);r.isFoil=!0;n.splice(0,0,r)}function s(){return[[new t("Battle for Zendikar","BFZ",null,null,function(n,t){var r=Math.random(),i;return r<1/6*(15/249)&&(i=ExpeditionsBFZ[Math.floor(Math.random()*ExpeditionsBFZ.length)],t.mythicCards.push(i)),t})],[new t("Magic Origins","ORI")],[new t("Modern Masters 2015","MM2",1)],[new t("Dragons of Tarkir","DTK"),new t("Fate Reforged","FRF"),new t("Khans of Tarkir","KTK")],[new t("Magic 2015","M15")],[new t("Journey into Nyx","JOU"),new t("Born of the Gods","BNG"),new t("Theros","THS")]]}function y(){return i[0][0]}function p(){return f.when(s())}function w(n){for(var r,u,t,e,f=[],i=0;i<n.length;i++){for(r=n[i],u=[],t=0;t<r.length;t++)e=$.extend({},r[t]),u.push(e);f.push(u)}return f}function b(){var n,r,t;if(!e.length)for(n=0;n<i.length;n++)for(r=i[n],t=0;t<r.length;t++)e.push({cardSet:r[t],setGroupNum:n,setNum:t});return f.when(e)}function k(n,t){return f.when(d(n,t))}function d(n,t){return o(i[n][t].shortName)}function o(n){return ft(h(n))}function h(n){return window[n]}function g(n){for(var u,t,e,f=new r,i=0;i<n.length;i++)for(u=n[i],t=0;t<u.length;t++)e=u[t],nt(f,c(e));return f}function c(n){var i=o(n.shortName),t=it(n.boostersToOpen,i);return t=tt(h(n.shortName),t,n.boostersToOpen,n.foilReplacesCommon,n.chanceOfFoil),t=n.addAdditionalCardsToPacks(i,t),ut(t),t}function l(n){this.Name=n.Name;this.Cost=n.Cost;this.Color=n.Color;this.Rarity=n.Rarity;this.Type=n.Type;this.Rating=n.Rating;this.Sort=n.Sort;this.Set=n.Set;this.Number=n.Number;this.Image=n.Image}function nt(n,t){n.mythicCards.push.apply(n.mythicCards,t.mythicCards);n.rareCards.push.apply(n.rareCards,t.rareCards);n.uncommonCards.push.apply(n.uncommonCards,t.uncommonCards);n.commonCards.push.apply(n.commonCards,t.commonCards)}function tt(n,t,i,r,u){for(var f,e=0;e<i;e++)Math.random()<u&&(console.log("adding foil card.."),r&&t.commonCards.pop(),f=new l(n[Math.floor(Math.random()*n.length)]),f.isFoil=!0,f.Rarity=="C"?t.commonCards.push(f):f.Rarity=="U"?t.uncommonCards.push(f):f.Rarity=="R"?t.rareCards.push(f):f.Rarity=="M"&&t.mythicCards.push(f));return t}function it(n,t){for(var u,i=new r,f=0;f<n;f++)u=rt(t,i),i.mythicCards.push.apply(i.mythicCards,u.mythicCards),i.rareCards.push.apply(i.rareCards,u.rareCards),i.uncommonCards.push.apply(i.uncommonCards,u.uncommonCards),i.commonCards.push.apply(i.commonCards,u.commonCards);return i}function rt(n){var u=new r,h=!0,o,s,f,e,i,t;for(Math.random()>1/8&&(h=!1),o=10,s=3,f=0;f<o;f++)i=Math.round(Math.random()*(n.commonCards.length-1)),t=n.commonCards[i],t!=null&&(e=!1,$.each(u.commonCards,function(n,i){i.Number==t.Number&&(e=!0)}),e&&n.commonCards.length>o?f--:u.commonCards.push(t));for(f=0;f<s;f++)i=Math.round(Math.random()*(n.uncommonCards.length-1)),t=n.uncommonCards[i],t!=null&&(e=!1,$.each(u.uncommonCards,function(n,i){i.Number==t.Number&&(e=!0)}),e?s++:u.uncommonCards.push(t));return h?(i=Math.round(Math.random()*(n.mythicCards.length-1)),t=n.mythicCards[i],u.mythicCards.push(t)):(i=Math.round(Math.random()*(n.rareCards.length-1)),t=n.rareCards[i],u.rareCards.push(t)),u}function r(){this.mythicCards=[];this.rareCards=[];this.uncommonCards=[];this.commonCards=[]}function u(n,t){return n.Number<t.Number?-1:n.Number>t.Number?1:0}function ut(n){n.mythicCards.sort(u);n.rareCards.sort(u);n.uncommonCards.sort(u);n.commonCards.sort(u)}function ft(n){var t=new r;return n.forEach(function(n){n.Rarity=="C"?t.commonCards.push(n):n.Rarity=="U"?t.uncommonCards.push(n):n.Rarity=="R"?t.rareCards.push(n):n.Rarity=="M"&&t.mythicCards.push(n)}),t}var f=n.$q,a={getCardSetByRarity:k,getCardSetGroups:p,getCardSetsAsFlatArray:b,openBoostersForCardSetGroups:g,openBoosterForCardSet:c,copyCardSetGroup:w,addPromoForLatestSet:v},i=s(),e=[];return a}angular.module("app").factory("datacontext",["common","landcards",n])})();
//# sourceMappingURL=datacontext.min.js.map
