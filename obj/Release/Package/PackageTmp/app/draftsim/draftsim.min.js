(function(){"use strict";function t(t,i,r,u,f,e){function c(n,t,i){var r=n.indexOf(i);r>-1&&n.splice(r,1);t.push(i)}function b(){t.activateController([],n).then(function(){o.landcards=f.getLandCards();var n=200,t=200;u.setPieChartGraphElement("colorPieChartContainer",n,t);u.setBarChartGraphElement("manaCurveBarChartContainer",n,t);u.setTypeChartHolder("typePieChartContainer",n,t)})}function k(){return o.boosters_to_open_core==null||o.boosters_to_open_ths==null||o.boosters_to_open_bng==null||o.boosters_to_open_jou==null||o.boosters_to_open_ktk==null||o.boosters_to_open_frf==null?(w("Please use a number for the amount of boosters."),!1):!0}function d(){for(var t,n=1;n<o.AIs.length;n++)processTurn(o.AIs[n]);for(t=[],n=0;n<o.AIs.length;n++)t.push(o.AIs[n].boosterCards);for(o.AIs[0].boosterCards=t[o.AIs.length-1],o.boosterCards=o.AIs[0].boosterCards,n=1;n<o.AIs.length;n++)o.AIs[n].boosterCards=t[n-1]}function g(){var n,t;for(o.AIs=[],n=0;n<o.numberOfPlayers;n++)t=new ai(n),v(t),o.AIs.push(t)}function v(n){var t=o.fixedFRFPacks;return o.packsOpened<=t?i.openMixtureOfSortedBoosters(0,0,0,0,0,1).then(function(t){return s(n,t)}):(t+=o.fixedKTKPacks,o.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,0,0,0,1,0).then(function(t){return s(n,t)}):(t+=o.fixedCorePacks,o.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,0,0,1,0,0).then(function(t){return s(n,t)}):(t+=o.fixedJOUpacks,o.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,0,1,0,0,0).then(function(t){return s(n,t)}):(t+=o.fixedBNGpacks,o.packsOpened<=t)?i.openMixtureOfSortedBoosters(0,1,0,0,0,0).then(function(t){return s(n,t)}):(t+=o.fixedTHSpacks,o.packsOpened<=t?i.openMixtureOfSortedBoosters(1,0,0,0,0,0).then(function(t){return s(n,t)}):void 0)}function s(n,t){return n.boosterCards.push.apply(n.boosterCards,t.mythicCards),n.boosterCards.push.apply(n.boosterCards,t.rareCards),n.boosterCards.push.apply(n.boosterCards,t.uncommonCards),n.boosterCards.push.apply(n.boosterCards,t.commonCards),n.boosterCards}var y=t.logger.getLogFn,h=y(n),p=t.logger.getLogFn(n,"success"),w=t.logger.getLogFn(n,"error"),o=this,l,a;o.title="Sealed Simulator";o.column1Title="Image";o.column2Title="Name";o.column3Title="Rarity";o.boosters_to_open=1;o.boosters_to_open_frf=0;o.boosters_to_open_ktk=3;o.boosters_to_open_core=0;o.boosters_to_open_jou=0;o.boosters_to_open_bng=0;o.boosters_to_open_ths=0;o.boosterCards=[];o.selectedCards=[];o.deckCards=[];o.draftFinished=!1;o.draftStarted=!1;o.packsOpened=0;o.totalPacksToOpen=3;o.fixedFRFPacks=0;o.fixedKTKPacks=0;o.fixedCorePacks=0;o.fixedJOUpacks=0;o.fixedBNGpacks=0;o.fixedTHSpacks=0;o.landcards=[];o.selectedLandCards=[];l="Booster Cards";o.topPanelCardsTitle=l;a="Selected Cards Stats";o.cardStatsTitle=a;o.showExtraOptions=!1;o.displayExtraOptions=function(){o.showExtraOptions=o.showExtraOptions?!1:!0};o.downloadFullPool=function(){r.saveCardsList(o.selectedCards.concat(o.deckCards),"MyDraftPool")};o.downloadDraftDeck=function(){r.saveCardsList(o.deckCards.concat(o.selectedLandCards),"MyDeckSelection")};o.addToDeck=function(n){c(o.boosterCards,o.selectedCards,n);p("You've chosen "+n.Name+"!");d();o.boosterCards.length==0&&(o.packsOpened<o.totalPacksToOpen?o.openNextPack():(o.draftFinished=!0,o.topPanelCardsTitle="Deck Cards"));u.displayChartsForCards(o.selectedCards)};o.cardPoolClick=function(n){o.draftFinished&&(c(o.selectedCards,o.deckCards,n),o.cardStatsTitle="My Deck Stats",u.displayChartsForCards(o.deckCards))};o.deckCardClick=function(n){o.draftFinished&&(c(o.deckCards,o.selectedCards,n),u.displayChartsForCards(o.deckCards))};o.landCardClick=function(n){o.draftFinished&&o.selectedLandCards.push(n)};o.removeLandCard=function(n){var t=o.selectedLandCards.indexOf(n);t>-1&&o.selectedLandCards.splice(t,1)};o.removeFromDeck=function(n){c(o.selectedCards,o.boosterCards,n)};o.openBoosters=function(){return i.openSortedBoosters(o.boosters_to_open).then(function(n){return h("Opened "+o.boosters_to_open+" booster packs."),o.boosterCards.push.apply(o.boosterCards,n.mythicCards),o.boosterCards.push.apply(o.boosterCards,n.rareCards),o.boosterCards.push.apply(o.boosterCards,n.uncommonCards),o.boosterCards.push.apply(o.boosterCards,n.commonCards),o.boosterCards})};o.openNextPack=function(){h("Opening a new pack...");o.packsOpened++;for(var n=0;n<o.numberOfPlayers;n++)v(o.AIs[n]);o.boosterCards=o.AIs[0].boosterCards;h("Packs opened: "+o.packsOpened+" Total packs to open: "+o.totalPacksToOpen)};b();o.numberOfPlayers=8;o.AIs=[];o.startDraft=function(){if(!k())return!1;o.draftStarted=!0;o.draftFinished=!1;o.topPanelCardsTitle=l;o.cardStatsTitle=a;u.resetAllCanvas();o.boosterCards=[];o.selectedCards=[];o.deckCards=[];o.selectedLandCards=[];o.fixedFRFPacks=parseInt(o.boosters_to_open_frf);o.fixedKTKPacks=parseInt(o.boosters_to_open_ktk);o.fixedCorePacks=parseInt(o.boosters_to_open_core);o.fixedBNGpacks=parseInt(o.boosters_to_open_bng);o.fixedTHSpacks=parseInt(o.boosters_to_open_ths);o.fixedJOUpacks=parseInt(o.boosters_to_open_jou);o.totalPacksToOpen=o.fixedBNGpacks+o.fixedTHSpacks+o.fixedJOUpacks+o.fixedCorePacks+o.fixedKTKPacks+o.fixedFRFPacks;o.packsOpened=1;g();o.boosterCards=o.AIs[0].boosterCards;h("You've started a new draft")};o.openHandSimulator=function(){var n=o.deckCards.concat(o.selectedLandCards),t;n.length>0?t=e.open({templateUrl:"handmodal.html",controller:"handmodal",resolve:{fullDeck:function(){return n}}}):h("Please add some cards to your deck (click on them below).")}}var n="draftsim";angular.module("app").controller(n,["common","datacontext","downloadDataService","graphAnalysis","landcards","$modal",t])})();
/*
//# sourceMappingURL=draftsim.min.js.map
*/